# Ultra Trading Order 系统对接文档

版本: 1.0.0
更新日期: 2026-01-06

---

## 目录
1. [系统概述](#1-系统概述)
2. [TCP网关协议](#2-tcp网关协议)
3. [MQ消息队列协议](#3-mq消息队列协议)
4. [业务数据模型](#4-业务数据模型)
5. [交互流程](#5-交互流程)
6. [错误处理](#6-错误处理)
7. [示例代码](#7-示例代码)

---

## 1. 系统概述

### 1.1 系统架构

```
┌─────────────┐          TCP          ┌──────────────────┐
│  订单网关   │ ◄──────────────────► │  Trading Order   │
│  Gateway    │                       │     Service      │
└─────────────┘                       └────────┬─────────┘
                                               │
                                               │ ZeroMQ
                                               ▼
                                      ┌──────────────────┐
                                      │   EMS System     │
                                      │  (撮合模拟)      │
                                      └──────────────────┘
```

### 1.2 通信方式

| 连接类型 | 协议 | 默认地址 | 用途 |
|---------|------|---------|------|
| TCP网关 | Netty TCP | 127.0.0.1:9900 | 订单下单、撤单、成交通知 |
| MQ消息队列 | ZeroMQ (PUSH) | tcp://127.0.0.1:5555 | 推送交易事件到EMS系统 |

---

## 2. TCP网关协议

### 2.1 协议格式

#### 2.1.1 传输层协议

采用 **Length-Prefix** 协议，防止TCP粘包/拆包问题：

```
+----------------+-----------------------------------+
|  4 Bytes (Int) |      N Bytes (UTF-8 JSON)        |
|   消息长度     |          消息体                   |
+----------------+-----------------------------------+
```

- **消息长度**: 32位整型（Big Endian），表示后续JSON字节数
- **消息体**: UTF-8编码的JSON字符串

#### 2.1.2 消息结构 (GatewayMessage)

```json
{
  "msgType": "消息类型",
  "msgId": "消息唯一ID",
  "timestamp": 1704528000000,
  "data": "{JSON格式的业务数据}"
}
```

| 字段 | 类型 | 必填 | 说明 |
|-----|------|------|------|
| msgType | String | 是 | 消息类型，见2.2节 |
| msgId | String | 是 | 消息唯一标识，建议UUID |
| timestamp | Long | 是 | 消息时间戳（毫秒） |
| data | String | 是 | JSON格式的业务数据（字符串） |

### 2.2 消息类型 (msgType)

| 消息类型 | 方向 | 说明 | data字段内容 |
|---------|------|------|-------------|
| ORDER_REQUEST | Client→Gateway | 订单请求 | OrderRequest JSON |
| ORDER_RESPONSE | Gateway→Client | 订单响应 | OrderResponse JSON |
| CANCEL_REQUEST | Client→Gateway | 撤单请求 | CancelRequest JSON |
| CANCEL_RESPONSE | Gateway→Client | 撤单响应 | CancelResponse JSON |
| TRADE_NOTIFY | Gateway→Client | 成交通知 | TradeNotify JSON |

### 2.3 消息详细定义

#### 2.3.1 ORDER_REQUEST (下单请求)

**data字段结构:**

```json
{
  "orderId": "ORD1704528000000_abc123",
  "userId": "user001",
  "symbol": "BTCUSDT",
  "orderType": "LIMIT",
  "side": "BUY",
  "price": "40000.00",
  "quantity": "1.5",
  "clientOrderId": "client_order_123"
}
```

| 字段 | 类型 | 必填 | 说明 |
|-----|------|------|------|
| orderId | String | 是 | 系统订单ID，格式：ORD+时间戳+UUID |
| userId | String | 是 | 用户ID |
| symbol | String | 是 | 交易对，如BTCUSDT |
| orderType | String | 是 | LIMIT(限价) / MARKET(市价) |
| side | String | 是 | BUY(买入) / SELL(卖出) |
| price | String | 否 | 价格（市价单可不传） |
| quantity | String | 是 | 数量 |
| clientOrderId | String | 否 | 客户端自定义订单ID |

#### 2.3.2 ORDER_RESPONSE (下单响应)

**data字段结构:**

```json
{
  "orderId": "ORD1704528000000_abc123",
  "status": "SUBMITTED",
  "code": 0,
  "message": "订单已提交"
}
```

| 字段 | 类型 | 说明 |
|-----|------|------|
| orderId | String | 订单ID |
| status | String | 订单状态（见4.2节） |
| code | Integer | 响应码，0表示成功 |
| message | String | 响应消息 |

#### 2.3.3 CANCEL_REQUEST (撤单请求)

**data字段结构:**

```json
{
  "orderId": "ORD1704528000000_abc123",
  "userId": "user001"
}
```

| 字段 | 类型 | 必填 | 说明 |
|-----|------|------|------|
| orderId | String | 是 | 要撤销的订单ID |
| userId | String | 是 | 用户ID |

#### 2.3.4 CANCEL_RESPONSE (撤单响应)

**data字段结构:**

```json
{
  "orderId": "ORD1704528000000_abc123",
  "status": "CANCELED",
  "code": 0,
  "message": "撤单成功"
}
```

| 字段 | 类型 | 说明 |
|-----|------|------|
| orderId | String | 订单ID |
| status | String | 订单状态 |
| code | Integer | 响应码 |
| message | String | 响应消息 |

#### 2.3.5 TRADE_NOTIFY (成交通知)

**data字段结构:**

```json
{
  "tradeId": "TRD1704528100000_xyz789",
  "orderId": "ORD1704528000000_abc123",
  "userId": "user001",
  "symbol": "BTCUSDT",
  "price": "40000.00",
  "quantity": "1.5",
  "fee": "0.0015",
  "feeAsset": "BTC",
  "tradeTime": 1704528100000,
  "isMaker": false
}
```

| 字段 | 类型 | 说明 |
|-----|------|------|
| tradeId | String | 成交ID |
| orderId | String | 关联订单ID |
| userId | String | 用户ID |
| symbol | String | 交易对 |
| price | String | 成交价格 |
| quantity | String | 成交数量 |
| fee | String | 手续费 |
| feeAsset | String | 手续费币种 |
| tradeTime | Long | 成交时间戳（毫秒） |
| isMaker | Boolean | 是否为Maker |

### 2.4 TCP连接管理

#### 2.4.1 连接参数

```yaml
gateway:
  tcp:
    host: 127.0.0.1          # 网关地址
    port: 9900               # 网关端口
    reconnect-interval: 5000 # 重连间隔（毫秒）
    connect-timeout: 10000   # 连接超时（毫秒）
```

#### 2.4.2 连接特性

- **心跳机制**: TCP_KEEPALIVE启用
- **Nagle算法**: TCP_NODELAY启用（降低延迟）
- **自动重连**: 断线后每5秒自动重连
- **编解码**: Netty Pipeline自动处理粘包拆包

#### 2.4.3 连接生命周期

```
连接建立 → 初始化Pipeline → 激活通道
    ↓
正常收发消息
    ↓
连接断开 → 触发重连 → 等待5秒 → 重新连接
```

---

## 3. MQ消息队列协议

### 3.1 协议概述

- **技术栈**: ZeroMQ (JeroMQ)
- **Socket类型**: PUSH (单向推送)
- **序列化**: JSON格式
- **用途**: 将交易事件推送到EMS系统进行模拟撮合

### 3.2 连接配置

```yaml
zeromq:
  ems:
    endpoint: "tcp://127.0.0.1:5555"  # EMS地址
    socket-type: PUSH                  # Socket类型
```

### 3.3 消息结构 (EmsMessage)

```json
{
  "eventType": "事件类型",
  "orderId": "ORD1704528000000_abc123",
  "timestamp": 1704528000000,
  "data": "{JSON格式的详细数据}"
}
```

| 字段 | 类型 | 必填 | 说明 |
|-----|------|------|------|
| eventType | String | 是 | 事件类型，见3.4节 |
| orderId | String | 是 | 关联订单ID |
| timestamp | Long | 是 | 事件时间戳（毫秒） |
| data | String | 是 | JSON格式的详细数据 |

### 3.4 事件类型 (eventType)

| 事件类型 | 触发时机 | 说明 | data字段内容 |
|---------|---------|------|-------------|
| ORDER_SUBMIT | 订单提交成功 | 通知EMS新订单已提交 | Order对象JSON |
| ORDER_CANCEL | 订单撤销请求 | 通知EMS撤销订单 | CancelRequest JSON |
| TRADE_FILLED | 订单成交 | 通知EMS订单成交信息 | Trade对象JSON |

### 3.5 事件详细定义

#### 3.5.1 ORDER_SUBMIT (订单提交事件)

**data字段结构:**

```json
{
  "orderId": "ORD1704528000000_abc123",
  "userId": "user001",
  "symbol": "BTCUSDT",
  "orderType": "LIMIT",
  "side": "BUY",
  "price": "40000.00",
  "quantity": "1.5",
  "filledQty": "0",
  "avgPrice": null,
  "status": "SUBMITTED",
  "createTime": 1704528000000,
  "updateTime": 1704528000000,
  "clientOrderId": "client_order_123"
}
```

#### 3.5.2 ORDER_CANCEL (订单撤销事件)

**data字段结构:**

```json
{
  "orderId": "ORD1704528000000_abc123",
  "userId": "user001",
  "cancelTime": 1704528100000
}
```

#### 3.5.3 TRADE_FILLED (成交事件)

**data字段结构:**

```json
{
  "tradeId": "TRD1704528100000_xyz789",
  "orderId": "ORD1704528000000_abc123",
  "userId": "user001",
  "symbol": "BTCUSDT",
  "price": "40000.00",
  "quantity": "1.5",
  "fee": "0.0015",
  "feeAsset": "BTC",
  "tradeTime": 1704528100000,
  "isMaker": false
}
```

### 3.6 消息发送特性

- **发送模式**: 异步非阻塞
- **超时时间**: 5000毫秒
- **重试机制**: 发送失败记录日志，不重试
- **消息序列化**: Jackson ObjectMapper

---

## 4. 业务数据模型

### 4.1 订单对象 (Order)

```java
{
  "orderId": "ORD1704528000000_abc123",
  "userId": "user001",
  "symbol": "BTCUSDT",
  "orderType": "LIMIT",
  "side": "BUY",
  "price": "40000.00",
  "quantity": "1.5",
  "filledQty": "0.5",
  "avgPrice": "39950.00",
  "status": "PARTIAL_FILLED",
  "createTime": 1704528000000,
  "updateTime": 1704528100000,
  "clientOrderId": "client_order_123"
}
```

| 字段 | 类型 | 说明 |
|-----|------|------|
| orderId | String | 订单ID，格式：ORD+时间戳+UUID |
| userId | String | 用户ID |
| symbol | String | 交易对（如BTCUSDT） |
| orderType | String | 订单类型：LIMIT/MARKET |
| side | String | 买卖方向：BUY/SELL |
| price | BigDecimal | 价格（市价单为null） |
| quantity | BigDecimal | 订单数量 |
| filledQty | BigDecimal | 已成交数量 |
| avgPrice | BigDecimal | 平均成交价 |
| status | String | 订单状态（见4.2节） |
| createTime | Long | 创建时间戳（毫秒） |
| updateTime | Long | 更新时间戳（毫秒） |
| clientOrderId | String | 客户端订单ID（可选） |

### 4.2 订单状态 (OrderStatus)

| 状态 | 说明 | 流转条件 |
|-----|------|---------|
| PENDING | 待提交 | 初始状态 |
| SUBMITTED | 已提交 | 网关接收订单 |
| PARTIAL_FILLED | 部分成交 | 0 < filledQty < quantity |
| FILLED | 完全成交 | filledQty = quantity |
| CANCELED | 已撤销 | 用户撤单或系统撤单 |
| REJECTED | 已拒绝 | 网关拒绝订单 |

**状态流转图:**

```
PENDING → SUBMITTED → PARTIAL_FILLED → FILLED
            ↓              ↓
         REJECTED      CANCELED
```

### 4.3 订单类型 (OrderType)

| 类型 | 说明 | 价格字段 |
|-----|------|---------|
| LIMIT | 限价单 | 必填 |
| MARKET | 市价单 | 不填 |

### 4.4 买卖方向 (OrderSide)

| 方向 | 说明 | 冻结资产 |
|-----|------|---------|
| BUY | 买入 | 冻结计价货币（price × quantity） |
| SELL | 卖出 | 冻结基础货币（quantity） |

### 4.5 成交对象 (Trade)

```java
{
  "tradeId": "TRD1704528100000_xyz789",
  "orderId": "ORD1704528000000_abc123",
  "userId": "user001",
  "symbol": "BTCUSDT",
  "price": "40000.00",
  "quantity": "1.5",
  "fee": "0.0015",
  "feeAsset": "BTC",
  "tradeTime": 1704528100000,
  "isMaker": false
}
```

| 字段 | 类型 | 说明 |
|-----|------|------|
| tradeId | String | 成交ID |
| orderId | String | 关联订单ID |
| userId | String | 用户ID |
| symbol | String | 交易对 |
| price | BigDecimal | 成交价格 |
| quantity | BigDecimal | 成交数量 |
| fee | BigDecimal | 手续费 |
| feeAsset | String | 手续费币种 |
| tradeTime | Long | 成交时间戳（毫秒） |
| isMaker | Boolean | 是否为Maker（挂单方） |

---

## 5. 交互流程

### 5.1 完整下单流程

```
客户端                Trading Service           TCP网关              EMS系统
  │                        │                      │                    │
  │  1. POST /api/order/submit                    │                    │
  │─────────────────────>│                        │                    │
  │                       │                        │                    │
  │                       │  2. 冻结资产           │                    │
  │                       │─────────┐              │                    │
  │                       │         │              │                    │
  │                       │<────────┘              │                    │
  │                       │                        │                    │
  │                       │  3. ORDER_REQUEST      │                    │
  │                       │───────────────────────>│                    │
  │                       │                        │                    │
  │                       │  4. ORDER_SUBMIT (ZMQ) │                    │
  │                       │────────────────────────┼───────────────────>│
  │                       │                        │                    │
  │                       │  5. ORDER_RESPONSE     │                    │
  │                       │<───────────────────────│                    │
  │                       │                        │                    │
  │  6. 订单提交成功       │                        │                    │
  │<─────────────────────│                        │                    │
  │                       │                        │                    │
  │                       │  7. TRADE_NOTIFY       │                    │
  │                       │<───────────────────────│                    │
  │                       │                        │                    │
  │                       │  8. 更新订单状态        │                    │
  │                       │  9. 更新资产           │                    │
  │                       │─────────┐              │                    │
  │                       │         │              │                    │
  │                       │<────────┘              │                    │
  │                       │                        │                    │
  │                       │  10. TRADE_FILLED (ZMQ)│                    │
  │                       │────────────────────────┼───────────────────>│
  │                       │                        │                    │
```

### 5.2 下单流程说明

**步骤1-2: 订单验证与资产冻结**
- 验证订单参数（价格、数量、交易对等）
- 根据买卖方向冻结对应资产
  - BUY: 冻结 `price × quantity` 的计价货币
  - SELL: 冻结 `quantity` 的基础货币

**步骤3: 发送TCP订单请求**
- 构造GatewayMessage，msgType=ORDER_REQUEST
- data字段包含完整订单信息
- 通过TCP连接发送到网关

**步骤4: 通知EMS系统**
- 构造EmsMessage，eventType=ORDER_SUBMIT
- 通过ZeroMQ PUSH到EMS系统
- EMS系统接收后进行模拟撮合

**步骤5: 网关响应**
- 网关处理订单后返回ORDER_RESPONSE
- 更新订单状态为SUBMITTED

**步骤6: 返回客户端**
- API接口返回订单提交结果
- 包含订单ID和当前状态

**步骤7-9: 成交处理**
- 网关推送TRADE_NOTIFY消息
- 更新订单的filledQty和avgPrice
- 根据成交情况更新订单状态
  - 部分成交: PARTIAL_FILLED
  - 完全成交: FILLED
- 更新用户资产余额
  - 解冻资产
  - 增加成交币种数量
  - 扣除手续费

**步骤10: 通知EMS成交**
- 发送TRADE_FILLED事件到EMS
- EMS系统更新成交记录

### 5.3 撤单流程

```
客户端                Trading Service           TCP网关              EMS系统
  │                        │                      │                    │
  │  1. POST /api/order/cancel/{orderId}          │                    │
  │─────────────────────>│                        │                    │
  │                       │                        │                    │
  │                       │  2. CANCEL_REQUEST     │                    │
  │                       │───────────────────────>│                    │
  │                       │                        │                    │
  │                       │  3. ORDER_CANCEL (ZMQ) │                    │
  │                       │────────────────────────┼───────────────────>│
  │                       │                        │                    │
  │                       │  4. CANCEL_RESPONSE    │                    │
  │                       │<───────────────────────│                    │
  │                       │                        │                    │
  │                       │  5. 更新订单状态        │                    │
  │                       │  6. 解冻资产           │                    │
  │                       │─────────┐              │                    │
  │                       │         │              │                    │
  │                       │<────────┘              │                    │
  │                       │                        │                    │
  │  7. 撤单成功           │                        │                    │
  │<─────────────────────│                        │                    │
  │                       │                        │                    │
```

### 5.4 资产变动规则

#### 5.4.1 买单(BUY)成交资产变动

**示例: BTCUSDT买单**
- 订单: 买入1 BTC，价格40000 USDT
- 成交: 1 BTC，手续费0.001 BTC

**资产变动:**
```
USDT:
  冻结: -40000
  可用: 不变

BTC:
  可用: +0.999 (1 - 0.001手续费)
```

#### 5.4.2 卖单(SELL)成交资产变动

**示例: BTCUSDT卖单**
- 订单: 卖出1 BTC，价格40000 USDT
- 成交: 1 BTC，手续费40 USDT

**资产变动:**
```
BTC:
  冻结: -1
  可用: 不变

USDT:
  可用: +39960 (40000 - 40手续费)
```

---

## 6. 错误处理

### 6.1 TCP连接错误

| 错误场景 | 处理方式 |
|---------|---------|
| 连接失败 | 每5秒自动重连 |
| 连接断开 | 触发重连机制 |
| 发送超时 | 记录日志，返回错误 |
| 解码异常 | 记录日志，丢弃消息 |

### 6.2 业务错误码

| 错误码 | 说明 | 处理建议 |
|-------|------|---------|
| 0 | 成功 | 正常处理 |
| 1001 | 订单不存在 | 检查订单ID |
| 1002 | 订单状态不允许操作 | 检查订单状态 |
| 1003 | 余额不足 | 检查账户余额 |
| 1004 | 交易对不存在 | 检查交易对配置 |
| 1005 | 参数错误 | 检查请求参数 |
| 9999 | 系统错误 | 联系技术支持 |

### 6.3 消息重复处理

**幂等性保证:**
- 使用msgId进行消息去重
- 建议使用UUID保证全局唯一性
- 重复消息直接丢弃，记录日志

---

## 7. 示例代码

### 7.1 TCP消息发送示例

#### 7.1.1 下单请求

```java
// 1. 构造订单数据
OrderRequest orderRequest = new OrderRequest();
orderRequest.setOrderId("ORD1704528000000_abc123");
orderRequest.setUserId("user001");
orderRequest.setSymbol("BTCUSDT");
orderRequest.setOrderType(OrderType.LIMIT);
orderRequest.setSide(OrderSide.BUY);
orderRequest.setPrice(new BigDecimal("40000.00"));
orderRequest.setQuantity(new BigDecimal("1.5"));

// 2. 序列化为JSON
ObjectMapper objectMapper = new ObjectMapper();
String dataJson = objectMapper.writeValueAsString(orderRequest);

// 3. 构造网关消息
GatewayMessage message = new GatewayMessage();
message.setMsgType("ORDER_REQUEST");
message.setMsgId(UUID.randomUUID().toString());
message.setTimestamp(System.currentTimeMillis());
message.setData(dataJson);

// 4. 发送消息（通过Netty Channel）
channel.writeAndFlush(message);
```

#### 7.1.2 撤单请求

```java
// 1. 构造撤单数据
Map<String, String> cancelData = new HashMap<>();
cancelData.put("orderId", "ORD1704528000000_abc123");
cancelData.put("userId", "user001");

// 2. 序列化为JSON
String dataJson = objectMapper.writeValueAsString(cancelData);

// 3. 构造网关消息
GatewayMessage message = new GatewayMessage();
message.setMsgType("CANCEL_REQUEST");
message.setMsgId(UUID.randomUUID().toString());
message.setTimestamp(System.currentTimeMillis());
message.setData(dataJson);

// 4. 发送消息
channel.writeAndFlush(message);
```

### 7.2 TCP消息接收示例

```java
@Override
public void channelRead0(ChannelHandlerContext ctx, GatewayMessage msg) {
    log.info("Received message: type={}, msgId={}",
             msg.getMsgType(), msg.getMsgId());

    switch (msg.getMsgType()) {
        case "ORDER_RESPONSE":
            handleOrderResponse(msg);
            break;
        case "CANCEL_RESPONSE":
            handleCancelResponse(msg);
            break;
        case "TRADE_NOTIFY":
            handleTradeNotify(msg);
            break;
        default:
            log.warn("Unknown message type: {}", msg.getMsgType());
    }
}

private void handleTradeNotify(GatewayMessage msg) {
    // 解析成交数据
    Trade trade = objectMapper.readValue(msg.getData(), Trade.class);

    // 更新订单状态
    Order order = getOrder(trade.getOrderId());
    order.setFilledQty(order.getFilledQty().add(trade.getQuantity()));
    order.setAvgPrice(calculateAvgPrice(order, trade));

    // 判断订单是否完全成交
    if (order.getFilledQty().compareTo(order.getQuantity()) >= 0) {
        order.setStatus(OrderStatus.FILLED);
    } else {
        order.setStatus(OrderStatus.PARTIAL_FILLED);
    }

    // 更新资产
    updateAsset(trade);

    // 保存订单和成交记录
    saveOrder(order);
    saveTrade(trade);
}
```

### 7.3 ZeroMQ消息发送示例

#### 7.3.1 订单提交事件

```java
// 1. 构造EMS消息
EmsMessage emsMessage = new EmsMessage();
emsMessage.setEventType("ORDER_SUBMIT");
emsMessage.setOrderId(order.getOrderId());
emsMessage.setTimestamp(System.currentTimeMillis());

// 2. 序列化订单数据
String dataJson = objectMapper.writeValueAsString(order);
emsMessage.setData(dataJson);

// 3. 发送到EMS
String messageJson = objectMapper.writeValueAsString(emsMessage);
boolean success = socket.send(messageJson.getBytes(StandardCharsets.UTF_8),
                               ZMQ.NOBLOCK);

if (!success) {
    log.error("Failed to send EMS message: {}", messageJson);
}
```

#### 7.3.2 成交事件

```java
// 1. 构造EMS消息
EmsMessage emsMessage = new EmsMessage();
emsMessage.setEventType("TRADE_FILLED");
emsMessage.setOrderId(trade.getOrderId());
emsMessage.setTimestamp(System.currentTimeMillis());

// 2. 序列化成交数据
String dataJson = objectMapper.writeValueAsString(trade);
emsMessage.setData(dataJson);

// 3. 发送到EMS
String messageJson = objectMapper.writeValueAsString(emsMessage);
socket.send(messageJson.getBytes(StandardCharsets.UTF_8), ZMQ.NOBLOCK);
```

### 7.4 完整消息示例

#### 7.4.1 TCP下单请求报文

```json
{
  "msgType": "ORDER_REQUEST",
  "msgId": "550e8400-e29b-41d4-a716-446655440000",
  "timestamp": 1704528000000,
  "data": "{\"orderId\":\"ORD1704528000000_abc123\",\"userId\":\"user001\",\"symbol\":\"BTCUSDT\",\"orderType\":\"LIMIT\",\"side\":\"BUY\",\"price\":\"40000.00\",\"quantity\":\"1.5\",\"clientOrderId\":\"client_order_123\"}"
}
```

**二进制格式（十六进制表示）:**
```
00 00 01 A4  // 长度: 420字节
7B 22 6D 73  // JSON开始: {"ms
67 54 79 70  // gTyp
...          // 完整JSON内容
```

#### 7.4.2 TCP成交通知报文

```json
{
  "msgType": "TRADE_NOTIFY",
  "msgId": "660e8400-e29b-41d4-a716-446655440001",
  "timestamp": 1704528100000,
  "data": "{\"tradeId\":\"TRD1704528100000_xyz789\",\"orderId\":\"ORD1704528000000_abc123\",\"userId\":\"user001\",\"symbol\":\"BTCUSDT\",\"price\":\"40000.00\",\"quantity\":\"1.5\",\"fee\":\"0.0015\",\"feeAsset\":\"BTC\",\"tradeTime\":1704528100000,\"isMaker\":false}"
}
```

#### 7.4.3 ZeroMQ订单提交事件

```json
{
  "eventType": "ORDER_SUBMIT",
  "orderId": "ORD1704528000000_abc123",
  "timestamp": 1704528000000,
  "data": "{\"orderId\":\"ORD1704528000000_abc123\",\"userId\":\"user001\",\"symbol\":\"BTCUSDT\",\"orderType\":\"LIMIT\",\"side\":\"BUY\",\"price\":\"40000.00\",\"quantity\":\"1.5\",\"filledQty\":\"0\",\"avgPrice\":null,\"status\":\"SUBMITTED\",\"createTime\":1704528000000,\"updateTime\":1704528000000,\"clientOrderId\":\"client_order_123\"}"
}
```

---

## 8. 附录

### 8.1 技术栈版本

| 组件 | 版本 |
|-----|------|
| Spring Boot | 3.2.1 |
| Java | 17 |
| Netty | 4.1.104.Final |
| JeroMQ | 0.6.0 |
| Jackson | 2.15.3 |
| Redisson | 3.25.0 |

### 8.2 配置参考

**完整配置文件 (application.yml):**

```yaml
# 服务器配置
server:
  port: 8080

# Redis配置
spring:
  redis:
    redisson:
      config: |
        singleServerConfig:
          address: "redis://127.0.0.1:6379"
          database: 0
          connectionPoolSize: 64
          connectionMinimumIdleSize: 10

# TCP网关配置
gateway:
  tcp:
    host: 127.0.0.1
    port: 9900
    reconnect-interval: 5000
    connect-timeout: 10000

# ZeroMQ配置
zeromq:
  ems:
    endpoint: "tcp://127.0.0.1:5555"
    socket-type: PUSH

# 日志配置
logging:
  level:
    com.uex.trading: DEBUG
```

### 8.3 性能参数

| 指标 | 数值 |
|-----|------|
| TCP连接数 | 1（长连接） |
| 消息编码延迟 | < 1ms |
| 消息解码延迟 | < 1ms |
| ZMQ发送超时 | 5000ms |
| TCP连接超时 | 10000ms |
| 自动重连间隔 | 5000ms |


**文档结束**
